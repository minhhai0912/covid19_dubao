rm(list = ls()) #lo???i b??? các giá tr??? có s???n t??? trý???c
library(Hmisc) # thý vi???n nh???p vào các giá tr??? c??n thi???u, phân c???m bi???n...

data <- read.csv("E:/study R/covid_R/COVID19_line_list_data.csv")
describe(data) #câu l???nh c???a thý vi???n Hmisc

# làm s???ch c???t t??? vong:
data$death_dummy <- as.integer(data$death !=0)
unique(data$death_dummy)
# t??? l??? t??? vong:
sum (data$death_dummy) / nrow(data)
 # câu h???i: có ph???i ngý???i t??? vong già hõn hay không
dead = subset(data, death_dummy == 1)
alive = subset(data, death_dummy == 0)

mean(dead$age, na.rm = TRUE)
mean(alive$age, na.rm = TRUE)

# câu h???i: có giá tr??? th???ng kê hay không
t.test(alive$age, dead$age, alternative = "two.side", conf.level = 0.95)
# giá tr??? p-value < 0.05 nên có giá tr??? th???ng kê

# nghi v???n 2: gi???i tính có ???nh hý???ng g?? không:
men = subset(data, gender =="male")
woman = subset(data, gender == "female")
mean (men$death_dummy, na.rm = TRUE)
mean (woman$death_dummy, na.rm = TRUE)

#Nh???n xét: t??? l??? nam gi???i t??? vong là 8.4% cao hõn 
# so v???i t??? l??? t??? vong ??? n??? gi???i là 3.6%

t.test(men$death_dummy, woman$death_dummy, alternative = "two.side", conf.level = 0.95)

#giá tr??? p-value < 0.05 nên có giá tr??? th???ng kê
# v???i ð??? tin c???y 95% th?? t??? l??? nam gi???i t??? vong cao hõn n??? gi???i giao ð???ng t??? 1.7% - 7.8%
